# Verb Edge 문법 명세서

**버전:** v0.1 (초안)  
**작성일:** 2026-01-28  
**목적:** GEUL 서술문 표현을 위한 Verb Edge 패킷 구조 정의

---

## 1. 개요

Verb Edge는 사건/행위를 표현하는 핵심 Edge 타입이다. 참여자 플래그를 통해 가변 길이 패킷을 구성하며, 하나의 Edge로 동사와 모든 참여자를 표현한다.

---

## 2. 패킷 구조

### 2.1 Verb Edge Packet

| 순서 | 필드 | 크기 | 설명 |
|------|------|------|------|
| 1 | Edge SIDX | 2워드 (32비트) | Edge 타입 + 참여자 플래그 |
| 2 | Edge TID | 1워드 (16비트) | 이 Edge의 TID 선언 |
| 3 | Verb SIDX | 4워드 (64비트) | 동사 SIDX + 한정자 |
| 4+ | 참여자 TID | 각 1워드 | 플래그 순서대로 가변 |

**최소 길이:** 7워드 (참여자 없음)  
**기본 타동사:** 10워드 (Agent + Theme + Recipient)

### 2.2 Edge SIDX 내부 구조 (32비트)

```
[Edge 타입: 16비트][참여자 플래그: 16비트]
```

| 비트 | 필드 | 설명 |
|------|------|------|
| 0-15 | Edge Type | Verb Edge 식별자 |
| 16-31 | Participant Flags | 참여자 존재 비트마스크 |

### 2.3 Verb SIDX 내부 구조 (64비트)

```
[동사 SIDX: 32비트][한정자: 32비트]
```

| 비트 | 필드 | 설명 |
|------|------|------|
| 0-31 | Verb SIDX | 동사 의미 식별자 |
| 32-63 | Modifiers | 동사 의미 한정자 |

---

## 3. 참여자 플래그 (16비트)

플래그 비트 위치 = 참여자 ID. 켜진 순서대로 TID가 뒤따름.

| 비트 | ID | 코드 | 역할 | 설명 |
|------|-----|------|------|------|
| 0 | 0x0 | AGT | Agent | 의도적 행위자 |
| 1 | 0x1 | EXP | Experiencer | 경험자 |
| 2 | 0x2 | THM | Theme | 대상 |
| 3 | 0x3 | PAT | Patient | 피영향자 |
| 4 | 0x4 | RCP | Recipient | 수혜자 |
| 5 | 0x5 | BNF | Beneficiary | 수익자 |
| 6 | 0x6 | INS | Instrument | 도구 |
| 7 | 0x7 | MNR | Manner | 방식 |
| 8 | 0x8 | LOC | Location | 장소 |
| 9 | 0x9 | SRC | Source | 출발점 |
| 10 | 0xA | DST | Destination | 목적지 |
| 11 | 0xB | PTH | Path | 경로 |
| 12 | 0xC | CAU | Cause | 원인 |
| 13 | 0xD | PRP | Purpose | 목적 |
| 14 | 0xE | COM | Comitative | 동반 |
| 15 | 0xF | ATR | Attribute | 속성 |

---

## 4. 한정자 구조 (32비트)

### 4.1 비트 할당 (22비트 사용, 10비트 예약)

| 비트 | 필드 | 크기 | 값 범위 |
|------|------|------|---------|
| 0-1 | Evidentiality | 2 | 추론/직접/전언 |
| 2-3 | Mood | 2 | 가정/서술/명령 |
| 4-5 | Modality | 2 | 의지 정도 |
| 6-7 | Tense | 2 | 과거/현재/미래 |
| 8-10 | Aspect | 3 | 진행/완료/결과 |
| 11-12 | Politeness | 2 | 반말/중립/존대 |
| 13-14 | Polarity | 2 | 부정/중립/긍정 |
| 15-16 | Volitionality | 2 | 의도성 |
| 17-18 | Confidence | 2 | 확신성 |
| 19-22 | Iterativity | 4 | 반복성 (0-15) |
| 23-31 | Reserved | 9 | 미래 확장용 |

### 4.2 양자화 매핑 (2비트)

| 값 | 의미 | 수치 |
|----|------|------|
| 00 | 강한 부정 | -1.0 |
| 01 | 약한 부정 | -0.3 |
| 10 | 약한 긍정 | +0.3 |
| 11 | 강한 긍정 | +1.0 |

---

## 5. 패킷 길이 계산

```
패킷 길이 = 7 + popcount(참여자 플래그)
```

| 참여자 수 | 패킷 길이 | 예시 |
|-----------|-----------|------|
| 0 | 7워드 | 날씨 서술 ("비가 온다") |
| 1 | 8워드 | 자동사 ("철수가 뛴다") |
| 2 | 9워드 | 타동사 ("철수가 공을 찬다") |
| 3 | 10워드 | 수여동사 ("철수가 영희에게 책을 줬다") |
| 5 | 12워드 | 복합문 |

---

## 6. WMS 처리

### 6.1 워드 수별 배열 분리

```
edge_7word[]: 참여자 0개
edge_8word[]: 참여자 1개 (주로 자동사)
edge_9word[]: 참여자 2개 (주로 타동사)
edge_10word[]: 참여자 3개 (수여동사)
...
```

### 6.2 장점

- 동일 길이끼리 SIMD 배치 처리
- 메모리 정렬 보장
- 인덱싱 O(1)

---

## 7. 예시

### 7.1 "철수가 영희에게 책을 줬다"

**Entity 선언:**
```
[Entity SIDX: 철수][TID: T001]  // 5워드
[Entity SIDX: 영희][TID: T002]  // 5워드
[Entity SIDX: 책][TID: T003]    // 5워드
```

**Verb Edge:**
```
[Edge SIDX: VerbEdge|AGT+THM+RCP]  // 2워드
[Edge TID: T100]                   // 1워드
[Verb SIDX: give.v.01 + 과거|긍정] // 4워드
[Agent TID: T001]                  // 1워드 (철수)
[Theme TID: T003]                  // 1워드 (책)
[Recipient TID: T002]              // 1워드 (영희)
```

**총:** 25워드

### 7.2 "비가 온다"

**Entity 선언:**
```
[Entity SIDX: 비][TID: T001]  // 5워드
```

**Verb Edge:**
```
[Edge SIDX: VerbEdge|THM]          // 2워드
[Edge TID: T100]                   // 1워드
[Verb SIDX: rain.v.01 + 현재|진행] // 4워드
[Theme TID: T001]                  // 1워드 (비)
```

**총:** 13워드

### 7.3 "친구와 함께 집에서 학교로 뛰어갔다"

**참여자 플래그:** `AGT|COM|SRC|DST` = 비트 0, 14, 9, 10

```
[Edge SIDX: VerbEdge|AGT+SRC+DST+COM]  // 2워드
[Edge TID: T100]                        // 1워드
[Verb SIDX: run.v.01 + 과거|완료]       // 4워드
[Agent TID: T001]                       // 1워드 (화자)
[Source TID: T002]                      // 1워드 (집)
[Destination TID: T003]                 // 1워드 (학교)
[Comitative TID: T004]                  // 1워드 (친구)
```

**총:** 12워드 (Edge) + 20워드 (Entity 4개) = 32워드

---

## 8. Triple Edge와의 비교

| 항목 | Verb Edge | Triple Edge |
|------|-----------|-------------|
| 용도 | 사건/행위 서술 | 속성/관계 서술 |
| 참여자 플래그 | 있음 (16비트) | 없음 |
| 가변 길이 | 있음 | 고정 (6워드) |
| Verb SIDX | 있음 (4워드) | 없음 |

---

## 9. 설계 근거

### 9.1 왜 가변 길이인가

별도 Edge 방식 vs 가변 방식 비교:

```
별도 Edge (참여자 3개):
  3 Edge × 7워드 = 21워드 (Verb 중복)

가변 방식:
  1 Edge × 10워드 = 10워드

절감: 52%
```

### 9.2 왜 TID 참조인가

- Entity는 여러 서술에서 재사용
- SIDX 직접 포함 시 4워드 × 참여자 수
- TID 참조 시 1워드 × 참여자 수

### 9.3 왜 Verb는 SIDX 직접인가

- 동사는 문장당 1회 (재사용 적음)
- 의미+한정자 즉시 접근 필요
- 캐싱/역참조 오버헤드 회피

---

## 10. 향후 과제

- [ ] Edge Type 코드 정의 (Verb Edge = 0x????)
- [ ] Aspect 3비트 비트마스크 상세 정의
- [ ] Null 참여자 표현 (TID=0?)
- [ ] 복합 사건 (연속 동작) 표현 방법

---

**문서 종료**