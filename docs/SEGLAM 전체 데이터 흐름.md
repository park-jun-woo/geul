# SEGLAM 전체 데이터 흐름

## 🧬 개요

SEGLAM(Self-Examination General Embedding Unified Language Architecture Model)은 기존 거대 단일 LLM의 한계를 해결하기 위해 설계된 차세대 AI 아키텍처입니다.

이 아키텍처는 **GEUL(General Embedding Unified Language)** 스트림을 데이터의 기본 형식으로 사용하며, **'추론 → 기록 → 성찰 → 개선'**의 선순환 구조를 통해 지속적으로 학습하고 성장합니다.

---

## 0. 🔤 GEUL Stream 구조 개요

SEGLAM 내부에서 모든 데이터 교환은 **GEUL Stream** 형식으로 이루어진다. GEUL Stream의 구조를 이해하는 것이 SEGLAM 아키텍처 이해의 기초이다.

### 0.1 Stream 경계

모든 GEUL Stream은 **Meta Node**로 시작하고 끝난다:

```
┌─────────────────────────────────────┐
│          STREAM_START               │  ← 필수 (TID 폭 선언)
├─────────────────────────────────────┤
│          메타데이터 (선택)            │
│          - VERSION                  │
│          - CREATED_AT               │
│          - CREATOR                  │
├─────────────────────────────────────┤
│          패킷들 (Node/Edge)          │
├─────────────────────────────────────┤
│          STREAM_END                 │  ← 선택 (권장)
└─────────────────────────────────────┘
```

### 0.2 GEUL 패킷 유형 (11종)

| 분류 | 패킷 타입 | Prefix | 용도 |
|------|-----------|--------|------|
| **제어** | Meta Node | `0 000 000` | 스트림 경계, 메타데이터 |
| **개체** | Entity Node | `0 1` | 개체(명사) 표현 |
| **수량** | Quantity Node | `0 01` | 수치/리터럴 표현 |
| **서술** | Verb Edge | `0 01` | 동사/술어 표현 |
| | Tiny Verb Edge | `0 1` | 고빈도 동사 약식 |
| **관계** | Triple Edge | `0 000 001` | 정적 관계/속성 |
| | Event6 Edge | `0 000 011` | 사건 (6하원칙) |
| | Clause Edge | `0 000 010` | 담화/논증 관계 |
| **구조** | Group Edge | `0 000 101` | 집합/그룹 정의 |
| | Context Edge | `0 000 100` | 맥락 연결 |
| **코드** | Faber Edge | `0 000 110` | AST/코드 표현 |

### 0.3 TID (Temporary ID) 체계

- **스코프:** 하나의 Stream 내에서만 유효
- **역할:** Stream 내 개체 간 참조 (자연어의 대명사 역할)
- **규칙:** 순방향 참조만 허용 (선언 후 참조)
- **폭:** 16비트(기본) / 32비트 / 64비트 (STREAM_START에서 선언)

---

## 1. 🌊 실시간 추론 및 응답 흐름 (의식적 과정)

사용자의 요청이 발생했을 때부터 답변이 생성되기까지의 실시간 데이터 흐름입니다.

### 1.1 [입력] 자연어 → GEUL-Encoder

사용자의 자연어 입력을 `GEUL-Encoder`가 받아, 명시적 요청과 암시적 정보가 담긴 `요청 GEUL Stream`을 생성합니다.

**생성되는 패킷 예시:**
- Entity Node: 언급된 개체들
- Verb Edge: 요청 동작
- Context Edge: 대화 맥락

### 1.2 [맥락 파악] GEUL-C → 심상관리 GPT

`GEUL-C (글씨)`가 `요청 GEUL Stream`과 캐시된 기존 `사용자 GEUL Stream`을 `심상관리GPT`에 전달합니다.

`심상관리 GPT`는 요청과 사용자 정보를 종합하여, 사용자의 현재 감정, 대화의 단기적 맥락, "만약 ~라면" 같은 가설적 상황을 포함한 `업데이트된 심상 GEUL Stream`을 생성합니다.

이 `업데이트된 심상 GEUL Stream`은 즉시 `글씨(GEUL-C)`에 다시 저장되어 캐시가 업데이트됩니다.

### 1.3 [쿼리 생성] → 쿼리 생성 GPT

`쿼리 생성 GPT`가 `[요청 GEUL Stream + 업데이트된 심상 GEUL Stream]`을 분석합니다.

WMS에서 어떤 정보와 절차를 찾아야 할지에 대한 최적의 `쿼리 GEUL Stream`을 생성합니다.

### 1.4 [정보 인출] WMS

`WMS`는 `쿼리 GEUL Stream`을 입력받아, 거대한 지식베이스에서 답변에 필요할 것으로 추측되는 `정보 GEUL Stream`(사실)과 `제어 GEUL Stream`(절차)을 초고속으로 인출하여 반환합니다.

**WMS 내부 포맷과 GEUL Stream의 관계:**

```
┌─────────────────────────────────────────────────────┐
│                      WMS                             │
│  ┌─────────────────────────────────────────────┐    │
│  │      내부 저장 포맷 (world.gwms)             │    │
│  │      - SoA 구조                              │    │
│  │      - 인덱스/버킷 최적화                     │    │
│  │      - 압축 저장                             │    │
│  └─────────────────────────────────────────────┘    │
│              ↑                    ↓                  │
│         [변환 레이어]        [변환 레이어]            │
│              ↓                    ↑                  │
│  ┌─────────────┐          ┌─────────────┐          │
│  │ 쿼리 GEUL   │          │ 결과 GEUL   │          │
│  │   Stream    │          │   Stream    │          │
│  └─────────────┘          └─────────────┘          │
└─────────────────────────────────────────────────────┘
```

- **GEUL Stream:** 외부 인터페이스 포맷 (GPT, 외부 시스템과의 통신)
- **world.gwms:** WMS 내부 최적화 포맷 (저장/인덱싱/검색)
- **변환 레이어:** GEUL ↔ 내부 포맷 상호 변환

### 1.5 [최종 추론] → 추론 GPT

`추론 GPT`가 `[요청 + 심상 + 정보 + 제어] Stream`들을 모두 바탕으로 최종적인 추론을 수행합니다.

`답변 GEUL Stream`을 생성합니다.

### 1.6 [출력] GEUL-Decoder → 자연어

`GEUL-Decoder`가 `답변 GEUL Stream`을 인간이 이해할 수 있는 자연스러운 언어로 번역하여 사용자에게 최종적으로 서비스합니다.

---

## 2. 🔄 자기 성찰 및 개선 흐름 (무의식적 과정)

시스템 유휴 상태 또는 응답 직후에 발생하는 백그라운드 학습 및 개선 흐름입니다.

### 2.1 [기록] 답변 → WMS

`추론 GPT`가 생성한 `답변 GEUL Stream`은 사용자에게 전달되는 동시에, 하나의 성공적인 '경험'으로서 WMS에 다시 저장됩니다.

### 2.2 [성찰] GEUL-Agent 활성화

시스템 유휴 상태일 때, `GEUL-Agent`들이 활성화됩니다.

Agent는 WMS에 새로운 자연어 정보(뉴스 등)를 GEUL Stream으로 번역하여 업데이트하거나, 새로 기록된 '경험'들을 다시 분석합니다.

### 2.3 [개선] 지식 및 절차 업데이트

Agent의 성찰을 통해 WMS의 자산이 개선됩니다.

- **지식 확장:** 새로운 정보나 성공적인 답변에서 새로운 `정보 GEUL Stream`(사실)을 추출하여 지식베이스를 확장합니다.
- **절차 개선:** 반복적으로 나타나는 성공 패턴을 발견하여 기존의 `제어 GEUL Stream`(절차)를 더 효율적으로 개선하거나 새로 생성합니다.
- **프로필 업데이트:** 대화 기록을 바탕으로 장기적인 `사용자 GEUL Stream`(프로필)를 업데이트합니다.

이러한 선순환 구조를 통해 SEGLAM은 자신의 경험으로부터 끊임없이 배우고 성장하는 지능형 시스템으로 진화하게 됩니다.

---

## 3. 📊 아키텍처 순환도

```
┌─────────────────────────────────────────────────────────────────┐
│                      SEGLAM 아키텍처                             │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              의식적 흐름 (실시간 추론)                      │   │
│  │                                                           │   │
│  │   사용자 → Encoder → 심상GPT → 쿼리GPT → WMS             │   │
│  │      ↑                              │        │            │   │
│  │      │                              ↓        ↓            │   │
│  │   사용자 ← Decoder ← 추론GPT ←── 정보+제어 Stream        │   │
│  │                          │                                │   │
│  └──────────────────────────│────────────────────────────────┘   │
│                             │                                    │
│                             ↓ (기록)                             │
│                    ┌────────────────┐                           │
│                    │      WMS       │                           │
│                    │  (지식베이스)   │                           │
│                    └────────────────┘                           │
│                             ↑ (개선)                             │
│                             │                                    │
│  ┌──────────────────────────│────────────────────────────────┐   │
│  │              무의식적 흐름 (자기 성찰)                       │   │
│  │                                                           │   │
│  │   외부정보 → GEUL-Agent → 분석/패턴발견 → 지식/절차 갱신   │   │
│  │                                                           │   │
│  └──────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. 📋 관련 문서

| 문서 | 내용 |
|------|------|
| `Stream_Format.md` | GEUL Stream 구성 규칙 |
| `Meta_Node.md` | STREAM_START/END, 메타데이터 |
| `Entity_Node.md` | 개체(Entity) 표현 |
| `Quantity_Node.md` | 수량/리터럴 표현 |
| `Verb_Edge.md` | 동사/술어 표현 |
| `Triple_Edge.md` | 정적 관계/속성 |
| `Event6_Edge.md` | 사건 (6하원칙) |
| `Clause_Edge.md` | 담화/논증 관계 |
| `Group_Edge.md` | 집합/그룹 정의 |
| `Context_Edge.md` | 맥락 연결 |
| `Faber_Edge.md` | AST/코드 표현 |
| `SIDX.md` | Prefix 체계, SIDX 의미 ID |

---

## 5. 버전 히스토리

| 버전 | 날짜 | 변경 |
|------|------|------|
| v0.1 | 2026-01-30 | 초안 |
| v0.2 | 2026-01-30 | Section 0 추가 (GEUL Stream 구조), 패킷 타입 목록 완성(11종), WMS 포맷 구분 명확화 |

---

**문서 종료**
