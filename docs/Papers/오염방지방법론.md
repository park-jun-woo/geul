# 오염방지방법론

## 0. 목적

본 문서는 GEUL/WMS/SEGLAM 기반 시스템에서 발생할 수 있는 **지식 오염(knowledge contamination)**을 최소화하기 위한 운영·설계·검수 방법론을 정의한다.  
여기서 오염이란 “그럴듯하지만 잘못된 서술/추론 결과가 BOOK → FACT/RULE → Canon/Consensus로 승격되며 장기적으로 축적·확산되는 현상”을 의미한다.

핵심 목표는 다음과 같다.

- **오염의 생성**을 줄인다.
- **오염의 승격**을 막는다.
- **오염의 전파**를 억제한다.
- **오염의 복구/롤백**을 가능하게 한다.
- **오염 비용 대비 효율**이 높은 인간 개입 구조를 확립한다.

---

## 1. 범위

본 방법론은 다음 시스템/흐름에 적용된다.

- GEUL 기반 서술 인코딩/디코딩
- WMS의 BOOK/FACT/RULE 레이어 운영
- SEGLAM의
  - 온라인 추론
  - 오프라인 성찰
  - 자기개선 파이프라인
- realworld.gwm 및 작품 세계관/2차 창작 월드

---

## 2. 용어

- **BOOK(L3)**: 출처가 있는 서술/기록/관찰의 저장 레이어.
- **FACT/RULE**: 합의·규칙·정전화된 사실/절차 저장 레이어.
- **Proposal**: 오프라인 성찰 또는 자동 추출로 생성되었으나 아직 검증되지 않은 후보 지식.
- **오염**: 검증 부족/환각/편향/출처 불명확/정책 위반 등으로 인한 잘못된 지식의 시스템 내 축적 및 승격.
- **전파**: 하나의 오염된 항목이 상위 Canon/Consensus, 또는 후속 학습/추론에서 반복 사용되는 현상.

---

## 3. 위협 모델

오염은 주로 다음 경로에서 발생한다.

1) **LLM 환각 기반 오염**
- 자연어에서 구조로 변환 시 과잉추론
- 요약 과정에서 사실 확정화

2) **출처/증거 부재 오염**
- “누가 말했는가/무엇을 근거로 하는가”가 없는 주장

3) **정책/절차 혼입 오염**
- 추론 규칙이 모델 파라미터 내부에 암묵적으로 고착

4) **시계열 왜곡**
- 사건 발생 시점과 기록 시점의 혼동

5) **IP/라이선스 경계 위반**
- 저작권 보호 대상 ‘표현’을 사실 데이터로 오인해 구조화/재배포

---

## 4. 기본 원칙

### 4.1 Provenance-First(출처 우선)
- BOOK/FACT/RULE의 모든 핵심 엔트리는 가능한 한 **출처 Edge를 최소 1개 이상** 첨부한다.
- 출처가 없는 항목은 명시 플래그를 가진다.
  - `source_missing = true`

### 4.2 Proposal-Only 기본 정책
- 시스템이 자동 생성/추출한 신규 지식은 **즉시 FACT/RULE로 승격하지 않는다.**
- 우선 **Proposal 풀**에 적재한다.

### 4.3 단계적 승격(생애주기)
다음 상태 전이를 기본 모델로 한다.

- `proposal → candidate → ratified → deprecated`

각 단계는 서로 다른 검수·샘플링 기준을 가진다.

### 4.4 분리의 원칙
- **추론과 절차를 분리**한다.
  - 절차는 가능한 한 GEUL 기반 **제어 스트림** 또는 Rule-as-Data로 외부화한다.
- 모델 파라미터 내부에 정책을 고정시키지 않는다.

### 4.5 불확실성 보존
- 상충 서술은 제거하지 않고 **확률적 중첩 참조(PSR)** 방식 등으로 공존시키는 전략을 권장한다.
- “애매한 것을 단정적 FACT로 바꾸는 행위”를 금지하거나 최소화한다.

---

## 5. 레이어별 오염 방지 전략

### 5.1 BOOK(L3)
BOOK은 오염의 “유입 레이어”이므로, **유입 차단보다 ‘정확한 라벨링’**이 중요하다.

필수 메타:
- `recorded_at`
- `event_time`
- `source_id`
- `speaker/issuer`
- `confidence`
- `evidence_link`

운영 규정:
- BOOK에는 **상충 서술을 허용**한다.
- BOOK에서 FACT 승격을 요청하는 자동 파이프라인은
  - 반드시 Proposal 단계를 거친다.

### 5.2 RULE
RULE은 오염 시 파급이 가장 큰 계층이다.

정책:
- RULE 신규 제안은 기본적으로
  - **엄격 심사 트랙**을 적용한다.
- RULE마다 다음을 기록한다.
  - `asserted_by`
  - `evidenced_by`
  - `derived_from`
  - `scope`(World/Context)

### 5.3 FACT
FACT는 정전화된 결과이므로 **설명가능성**이 핵심이다.

필수:
- `derived_from` 체인 유지
- `batch_id`
- `approved_by`
- `approved_at`

규정:
- 출처·증거·파생 기록이 없는 FACT는
  - 기본적으로 “정전 후보”로 취급하지 않는다.

---

## 6. SEGLAM 루프 기반 오염 방지

### 6.1 온라인 추론 단계
목표: **오염 생성 자체를 줄이기**

- 인코더는
  - 동사 의미 한정자(시제/상/양태/확신성/전언성 등)를 가능한 명시적으로 생성한다.
- 추론 GPT는
  - 사실 단정과 가설 제시를 구분한다.
  - 불확실성을 BOOK 형태로 기록하도록 유도한다.
- 높은 위험 도메인(정치/의학/법률 등)은
  - 기본적으로 “가설/전언 라벨”을 강제한다.

### 6.2 오프라인 성찰 단계
목표: **오염 승격을 차단**

- 모든 신규 지식은 Proposal 풀로만 이동.
- Agent는 다음을 우선 수행한다.
  1) 출처/증거 연결 시도
  2) 기존 Canon/Consensus와 충돌 탐지
  3) 중복/동의어/ID 충돌 정규화
  4) 불확실성 유지 여부 판단

---

## 7. 인간 개입 + 샘플 평가 프로토콜

### 7.1 왜 샘플 평가인가
전수 검수는 비용이 과도하므로,  
**샘플링 기반 품질 게이트**를 기본 전략으로 채택한다.

### 7.2 샘플링 원칙
- **위험도 기반 계층 샘플링**
  - 자동 생성 FACT 후보
  - 기존 정전과 충돌하는 제안
  - 낮은 신뢰 출처 기반 제안
  - “핫 이슈” 최신 뉴스 기반 제안  
  → 샘플 비중을 높인다.

- **충돌 중심 샘플링**
  - `conflict_detected = true` 우선 추출

- **중요도 가중치**
  - 코어 타입/코어 룰/대형 사건은
    - **승격 임계치 강화**
    - **샘플 비율 강화**

### 7.3 배치별 승격 기준(예시)
- 배치 오염률 추정이 임계치 이하일 때만 승격.
- 임계치 예시:
  - 일반 FACT 후보: ≤ 2%
  - 코어 RULE 후보: ≤ 0.5%
- 임계치 값은 월드 성격에 따라 조정 가능.

### 7.4 검수 UI 최소 요구
검수 효율을 위해 다음 표시를 요구한다.

- Claim 요약
- 출처/증거/파생 체인
- 충돌 목록
- 제안이 영향을 미칠 Canon/Consensus 범위

---

## 8. 자동 탐지 장치

### 8.1 충돌 탐지
- Canon/Consensus 대비 불일치 감지
- 시간축 모순 감지

### 8.2 이상치 탐지
- 특정 Source/Issuer에서 비정상적으로 많은 신규 FACT가 발생하는 경우
- 특정 Agent 버전 이후 오염률이 증가하는 경우

### 8.3 중복/동의어 정규화
- 동일 사건/동일 인물의 다중 ID 생성 방지

---

## 9. PSR(확률적 중첩 참조) 적용 가이드

- 상충 서술이 있을 경우:
  - 즉시 하나를 폐기하지 않는다.
  - 확률/가중치 또는 “경쟁 가설”로 병렬 저장한다.
- 이 구조를 유지하면
  - LLM이 “단정적 환각”으로 FACT를 밀어 올리기 어려워진다.

---

## 10. 제어 스트림(절차 외부화) 적용 가이드

- 추론의 “방법/정책”은
  - 가능한 한 GEUL 제어 스트림 또는 Rule-as-Data로 기록한다.
- 장점:
  - 사람에 의한 감사/수정 가능
  - 오염이 모델 습관으로 고착되는 위험 감소
  - 롤백이 쉬워짐

---

## 11. 롤백/격리 전략

### 11.1 배치 단위 롤백
승격 모든 단위에
- `batch_id`
- `approved_by`
- `approved_at`
를 남긴다.

오염 확인 시:
- 배치 전체를 **안전하게 되돌릴 수 있어야 한다.**

### 11.2 격리 영역
문제가 의심되는 제안은
- `quarantine` 상태로 이동,
- 추가 검증 전까지 상위 추론에서 제외한다.

---

## 12. 저작권/라이선스 오염 방지

- 저작권 살아있는 IP는
  - **위키데이터 수준의 최소 메타/식별 정보로 제한**한다.
- 상세 설정/플롯/서술 구조화는
  - **권리자 제공/승인 데이터에 한정**한다.
- 퍼블릭 도메인 작품은
  - BOOK/FACT/RULE까지 확장 구조화 가능하다.

---

## 13. 운영 지표(최소 세트)

- **Proposal 오염률**
- **승격 후 오염 발견률**
- **Source별 오염 기여도**
- **Agent 버전별 오염 변화**
- **롤백 빈도/원인 분포**
- **충돌 발생률 및 해결 시간**

---

## 14. 체크리스트

### 14.1 신규 지식 생성 시
- [ ] 출처 Edge가 있는가?
- [ ] 불확실성(전언/추정/가설)이 유지됐는가?
- [ ] 기존 Canon과 충돌하는가?

### 14.2 Proposal → Candidate 승격 전
- [ ] 위험도 기반 샘플링을 통과했는가?
- [ ] 충돌 항목이 검수됐는가?
- [ ] derived_from 체인이 있는가?

### 14.3 Candidate → Ratified 승격 전
- [ ] 배치 오염률 임계치를 통과했는가?
- [ ] 코어 룰/타입에 대한 강화 기준을 적용했는가?
- [ ] 롤백 메타(batch_id 등)가 완비됐는가?

---

## 15. 결론

오염 방지는 기술만으로 해결되지 않는다.  
GEUL/WMS/SEGLAM의 강점은 다음을 **구조적으로 가능하게 한다는 점**이다.

1) 출처/증거/파생의 명시
2) Proposal 기반 단계적 승격
3) PSR을 통한 불확실성 보존
4) 제어 스트림을 통한 절차 외부화
5) 배치 단위 샘플 검수와 롤백

본 방법론은 이 다섯 축을 기준으로  
**“오염을 없애는 시스템”이 아니라  
“오염을 값싸고 확실하게 통제하는 시스템”**을 목표로 한다.
