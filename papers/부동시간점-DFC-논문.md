# 부동시간점(Double Floating Chrono): 비트마스크 기반 다해상도 시간 탐색을 위한 계층적 시간 인코딩

**Double Floating Chrono: A Hierarchical Time Encoding for Bitmask-Based Multi-Resolution Temporal Search**

---

## 초록 (Abstract)

시간 범위 탐색은 지식 시스템의 기본 연산이다. 그러나 Unix 타임스탬프와 같은 전통적 선형 시간 표현에서 범위 탐색은 두 번의 비교 연산과 사전 계산된 경계값을 요구한다. 본 논문은 IEEE 754 부동소수점의 지수부-가수부 구조에서 영감을 얻은 새로운 시간 인코딩 방식인 **DFC(Double Floating Chrono, 부동시간점)**를 제안한다. DFC는 시간을 비트 계층으로 분리하여, 상위 비트가 거시적 시간(연-월-일)을, 하위 비트가 미시적 시간(시-분-초)을 표현한다. 이 구조는 비트마스크 한 번으로 임의 해상도의 시간 범위 탐색을 가능하게 한다. 특히 의미정렬 식별자(SIDX)와 결합할 경우, 엔티티 필터와 시간 필터를 단일 SIMD 연산으로 동시 처리할 수 있다. 부수적으로, 비트 손실 시 하위 비트(미시적 시간)부터 소실되므로, 데이터 손실 환경에서 예측 가능한 우아한 열화(Graceful Degradation)가 자연스럽게 달성된다.

**키워드**: 시간 인코딩, 비트마스크 탐색, SIMD, 다해상도 검색, 우아한 열화, 지식 그래프

---

## 1. 서론

### 1.1 시간 범위 탐색의 비용

지식 시스템에서 시간은 가장 빈번한 필터링 조건 중 하나다. "2024년 3분기 삼성전자 실적", "지난주 서버 장애 로그", "올해 발표된 논문" — 거의 모든 질의에 시간 범위가 포함된다.

현재 표준적 시간 표현인 Unix 타임스탬프(epoch 이후 초 단위 정수)에서 범위 탐색은 다음과 같이 수행된다.

```
WHERE timestamp >= 1719792000 AND timestamp < 1727740800
```

이 방식에는 세 가지 비용이 있다.

**경계값 사전 계산.** "2024년 3분기"를 초 단위 정수 두 개로 변환해야 한다. 이 변환은 자명하지 않다. 윤초, 시간대, 윤년을 고려해야 한다.

**이중 비교 연산.** 매 레코드마다 하한과 상한에 대해 두 번의 비교가 필요하다. SIMD 환경에서는 비교 명령 두 번과 AND 한 번, 총 세 번의 연산이다.

**해상도 전환 불가.** "2024년 전체"와 "2024년 9월 1일"은 같은 방식으로 처리된다. 두 번의 비교. 해상도가 넓어져도 비용이 줄지 않는다.

### 1.2 비트마스크 탐색의 가능성

IP 주소의 서브넷 마스크는 다른 접근을 보여준다.

`192.168.0.0/16`은 "상위 16비트가 `192.168`인 모든 주소"를 의미한다. 범위를 두 번의 비교가 아닌 비트마스크 한 번으로 표현한다. 마스크의 길이를 바꾸면 해상도가 바뀐다. `/8`이면 더 넓고, `/24`이면 더 좁다.

이것이 가능한 이유는 IP 주소가 **계층적으로 설계**되었기 때문이다. 상위 비트가 네트워크를, 하위 비트가 호스트를 표현한다. 비트의 위치에 의미가 있다.

Unix 타임스탬프에서는 이것이 불가능하다. 1719792000이라는 숫자의 상위 비트에 "연도"가 담겨 있지 않다. 비트의 위치에 의미가 없다. 선형 정수이기 때문이다.

본 논문은 묻는다: **시간을 IP 주소처럼 설계할 수 있는가?**

---

## 2. DFC 프레임워크

### 2.1 설계 원리

DFC의 핵심 아이디어는 시간을 선형 정수가 아닌 **비트 계층**으로 표현하는 것이다. IEEE 754 부동소수점이 숫자를 지수부(값의 스케일)와 가수부(세부 정밀도)로 분리하듯이, DFC는 시간을 거시적 부분과 미시적 부분으로 분리한다.

**일이상부 (Day-part, 상위 비트):** 기준점(epoch)으로부터의 일(day) 수. 시간의 거시적 위치를 결정한다.

**일이하부 (Sub-day-part, 하위 비트):** 하루 내에서의 위치. 86,400초를 양자화한 값.

이 분리의 핵심적 결과: 상위 비트만으로 "어느 날인가"가 확정되고, 하위 비트를 추가할수록 "그 날의 언제인가"가 정밀해진다.

### 2.2 비트 레이아웃

32비트 DFC의 기본 레이아웃:

```
[S][YYYYYYYYY][MMMM][DDDDD][HHHHH][MMMMMM][SSSSS]
 1     9        4      5      5       6       5
 부호   연       월     일     시      분    초(2초단위)

총: 1 + 9 + 4 + 5 + 5 + 6 + 5 = 35비트 → 32비트로 압축 시 초 필드 조정
```

**32비트 실용 레이아웃:**

```
[YYYYYYYYYYY][MMMM][DDDDD][HHHHH][MMMMMM][S]
     11        4      5      5       6     1

연: 11비트 → 2048년 범위 (0~2047 또는 1970~4017)
월: 4비트  → 1~12
일: 5비트  → 1~31
시: 5비트  → 0~23
분: 6비트  → 0~59
초: 1비트  → 전반/후반 (30초 단위)
```

**16비트 압축 레이아웃 (GEUL 토큰용):**

```
[YYYYYYYYY][MMMM][DDD]
     9        4     3

연: 9비트  → 512년 범위
월: 4비트  → 1~12
일: 3비트  → 4일 단위 (1-4, 5-8, ..., 29-31)
```

비트 폭은 용도에 따라 확장 또는 축소된다. 핵심은 **비트의 위치가 시간의 계층을 반영한다**는 것이다.

### 2.3 부동소수점과의 구조적 유사성

| | IEEE 754 | DFC |
|---|---|---|
| 상위 비트 | 지수부 (값의 스케일) | 일이상부 (시간의 거시적 위치) |
| 하위 비트 | 가수부 (세부 정밀도) | 일이하부 (시간의 미시적 위치) |
| 상위 비트 손실 | 값의 크기 정보 소실 | 날짜 정보 소실 |
| 하위 비트 손실 | 정밀도 감소, 근사값 유지 | 시각 정보 소실, 날짜 유지 |
| 마스크 효과 | 유효숫자 자릿수 조절 | 시간 해상도 조절 |

---

## 3. 비트마스크 기반 다해상도 탐색

### 3.1 마스크 길이에 의한 해상도 제어

DFC의 핵심 연산은 비트마스크를 통한 시간 범위 탐색이다.

**질의: "2024년 전체"**

```
값:    [00000110110][____][_____][_____][______][_]
마스크: [11111111111][0000][00000][00000][000000][0]
```

상위 11비트(연도)만 비교. 나머지는 무시.

**질의: "2024년 9월"**

```
값:    [00000110110][1001][_____][_____][______][_]
마스크: [11111111111][1111][00000][00000][000000][0]
```

상위 15비트(연도+월)만 비교.

**질의: "2024년 9월 1일"**

```
값:    [00000110110][1001][00001][_____][______][_]
마스크: [11111111111][1111][11111][00000][000000][0]
```

상위 20비트(연도+월+일)만 비교.

**질의: "2024년 9월 1일 15시"**

```
값:    [00000110110][1001][00001][01111][______][_]
마스크: [11111111111][1111][11111][11111][000000][0]
```

상위 25비트.

모든 경우에 연산은 동일하다: `(record AND mask) == (query AND mask)`. 비교 한 번. 해상도가 달라져도 연산 구조가 바뀌지 않는다.

### 3.2 Unix 타임스탬프와의 비교

| 질의 | Unix timestamp | DFC |
|---|---|---|
| 2024년 전체 | `>= 1704067200 AND < 1735689600` | `AND mask, CMP` |
| 2024년 9월 | `>= 1725148800 AND < 1727740800` | `AND mask, CMP` |
| 2024년 9월 1일 | `>= 1725148800 AND < 1725235200` | `AND mask, CMP` |
| 연산 수 | 비교 2회 + AND 1회 = 3 ops | AND 1회 + CMP 1회 = 2 ops |
| 경계값 계산 | 필요 (윤초/시간대 고려) | 불필요 |
| 해상도 전환 | 경계값 재계산 | 마스크 길이 변경 |

### 3.3 SIMD 처리

AVX-512 환경에서 32비트 DFC 레코드를 처리할 경우:

```
512비트 레지스터 / 32비트 = 16 레코드 동시 처리

VPANDD zmm0, zmm_records, zmm_mask     ; 16개 레코드에 마스크 적용
VPCMPEQD k1, zmm0, zmm_query           ; 16개 동시 비교
; k1에 매칭 결과 비트마스크
```

한 사이클에 16개 레코드의 시간 범위 판정이 완료된다.

Unix 타임스탬프의 경우:

```
VPCMPD k1, zmm_records, zmm_lower, 5   ; >= lower (16개)
VPCMPD k2, zmm_records, zmm_upper, 1   ; < upper (16개)
KANDD k3, k1, k2                        ; AND (16개)
; 3 명령어
```

명령어 수의 차이는 작아 보이지만, 대규모 스캔에서 누적된다. 더 중요한 차이는 **경계값 사전 계산의 제거**와 **해상도 전환의 제로 코스트**다.

---

## 4. SIDX와의 결합: 엔티티-시간 동시 필터링

### 4.1 SIDX의 비트마스크 탐색

SIDX(Semantic-aligned Index)는 엔티티의 의미 정보를 비트 위치에 인코딩한 64비트 식별자다. 상위 비트가 엔티티의 타입 계층을 표현한다.

```
상위 8비트만 비교:  "모든 기업" 매칭
상위 16비트 비교:   "한국 기업" 매칭
전체 64비트 비교:   "삼성전자" 정확 매칭
```

DFC와 동일한 원리다. 비트마스크 길이가 해상도를 결정한다.

### 4.2 복합 질의의 단일 연산

SIDX와 DFC를 연결(concatenate)하면 엔티티와 시간을 하나의 비트열로 표현할 수 있다.

```
[SIDX 64비트][DFC 32비트] = 96비트 복합 키

질의: "한국 기업 + 2024년 3분기"

SIDX 마스크: [상위 16비트 ON][나머지 OFF]  → "한국 기업"
DFC 마스크:  [연월 ON][나머지 OFF]          → "2024년 7~9월"
복합 마스크: [SIDX 마스크][DFC 마스크]
```

이 복합 키에 대한 필터링이 **단일 SIMD 연산**으로 처리된다.

```
VPANDD + VPCMPEQD → 엔티티 필터와 시간 필터 동시 완료
```

기존 방식에서는 엔티티 필터링과 시간 필터링이 별도의 단계다. 엔티티 인덱스에서 후보를 추리고, 그 후보에 대해 시간 범위를 검사한다. 두 단계. DFC+SIDX에서는 한 단계다.

### 4.3 다차원 질의 확장

같은 원리로 추가 차원을 결합할 수 있다.

```
[SIDX 64비트][DFC 32비트][확신도 8비트][출처유형 8비트] = 112비트

질의: "한국 기업 + 2024년 + 확신도 0.8 이상 + 1차 자료"
→ 단일 복합 마스크로 동시 필터링
```

컨텍스트 엔지니어링 파이프라인에서 검증, 필터링, 시간 범위 검사가 하나의 비트 연산으로 통합된다.

---

## 5. 우아한 열화: 설계의 부산물

### 5.1 비트마스크 탐색에서 우아한 열화로

DFC의 비트 계층 구조는 범위 탐색을 위해 설계되었다. 그런데 이 구조는 데이터 손실 시 자연스러운 열화 특성을 부산물로 갖는다.

비트가 하위부터 손실되면:

| 잔존 비트 | 해석 | 정보 |
|---|---|---|
| 32비트 (전체) | 2024-09-01 15:30 (±30초) | 완전 |
| 25비트 | 2024-09-01 15시대 | 시각 수준 |
| 20비트 | 2024-09-01 | 일 수준 |
| 15비트 | 2024년 9월 | 월 수준 |
| 11비트 | 2024년 | 연 수준 |

Unix 타임스탬프에서 하위 비트가 손실되면:

| 잔존 비트 | 해석 |
|---|---|
| 32비트 (전체) | 2024-09-01 15:30:00 |
| 25비트 | 값이 128배 왜곡 → 해석 불가 |
| 20비트 | 값이 4096배 왜곡 → 해석 불가 |

DFC에서 하위 비트 손실은 "언제쯤"이 된다. Unix에서 하위 비트 손실은 "알 수 없다"가 된다.

### 5.2 열화의 예측 가능성

DFC의 열화는 예측 가능하다. 마스크 길이가 줄어드는 것과 비트가 손실되는 것이 같은 효과를 갖기 때문이다.

마스크를 11비트로 설정하면 "2024년" 수준의 탐색.
11비트만 남으면 "2024년" 수준의 정보.

의도적 해상도 축소와 비의도적 데이터 손실이 동일한 수학적 구조를 갖는다. 이것이 "우아한 열화는 비트마스크 탐색의 부산물이다"의 의미다.

### 5.3 인간적 시간과의 정합

인간은 시간을 계층적으로 인식한다. "2024년 9월 1일 오후 3시 30분"을 기억하지 못하면 "9월 초쯤"으로 기억한다. "9월 초쯤"도 모르면 "작년 가을쯤"으로 기억한다.

이것은 정확히 DFC의 열화 경로다. 하위 비트가 소실될수록 시간은 추상화되지만 완전히 사라지지 않는다.

Unix 타임스탬프의 열화 경로는 인간의 시간 인식과 정합하지 않는다. 1725199800의 하위 비트가 손실되면 "9월 초쯤"이 아니라 의미 없는 숫자가 된다.

---

## 6. 관련 연구

**선형 타임스탬프.** Unix timestamp, Windows FILETIME, NTP timestamp. 모두 기준점 이후의 선형 카운터다. 비트 위치에 시간 의미가 없으므로 비트마스크 탐색이 불가능하다.

**구조화된 시간 표현.** ISO 8601 ("2024-09-01T15:30:00Z")은 인간이 읽을 수 있지만 문자열이다. 비트 연산에 적합하지 않다. 파싱 비용이 있다.

**BCD 시간.** Binary-Coded Decimal로 년/월/일/시/분/초를 각각 인코딩하는 방식이 RTC(Real-Time Clock) 하드웨어에서 사용된다. DFC와 유사한 계층 구조를 가지지만, BCD의 목적은 하드웨어 디스플레이 편의이며 비트마스크 범위 탐색이나 SIMD 최적화는 고려되지 않았다.

**부동소수점 시계열 압축.** Gorilla (2015), Chimp (2022), Elf* (2024). 시계열 데이터의 저장 공간 절약이 목적이며, 시간 표현 자체의 재설계가 아니다.

**의미정렬 식별자.** SIDX는 엔티티 식별자의 비트 위치에 의미 계층을 인코딩한다. DFC는 이 원리를 시간 도메인에 적용한 것으로 볼 수 있다.

---

## 7. 논의

### 7.1 제한 사항

**비균등 범위.** 월의 길이가 28~31일로 다르다. 4비트로 월을 표현하면 "2월"과 "7월"이 같은 비트 폭을 차지한다. 이것은 범위 탐색에서 "3월 전체"가 정확히 31일이 아닐 수 있음을 의미한다. 그러나 비트마스크 탐색의 의미론은 "이 월에 속하는 모든 레코드"이므로, 월의 길이 차이는 탐색 결과의 정확성에 영향을 주지 않는다.

**시간대.** DFC는 UTC 기준 단일 시간대를 전제한다. 시간대 변환은 DFC 밖에서 처리되어야 한다.

**윤초.** 일이하부가 86,400초를 전제하므로 윤초가 있는 날은 1초의 오차가 발생한다. 대부분의 응용에서 무시 가능하다.

### 7.2 구현 고려사항

**기존 시스템과의 변환.** Unix timestamp ↔ DFC 변환은 정수 나눗셈과 모듈로 연산으로 수행된다. 비용이 낮다.

**인덱싱.** DFC의 비트 계층 구조는 B-tree 인덱싱과 자연스럽게 호환된다. 상위 비트에 의한 프리픽스 매칭이 B-tree의 범위 스캔과 동일한 구조이기 때문이다.

**가변 정밀도 저장.** DFC의 비트 레이아웃은 용도에 따라 축소 가능하다. 일 수준의 정밀도만 필요하면 20비트, 월 수준이면 15비트. 고정 크기가 아닌 가변 크기 저장이 가능하다. 이것 자체가 압축이다.

---

## 8. 결론

DFC(부동시간점)는 시간을 비트 계층으로 표현하여, 비트마스크 한 번으로 임의 해상도의 범위 탐색을 가능하게 하는 시간 인코딩 방식이다.

핵심 기여는 세 가지다.

**비트마스크 범위 탐색.** 마스크 길이가 해상도를 결정한다. 경계값 사전 계산이 불필요하다. 해상도 전환에 추가 비용이 없다. SIMD 단일 연산으로 처리된다.

**SIDX 결합.** 엔티티 식별자와 시간을 복합 비트열로 연결하면, 엔티티 필터와 시간 필터를 단일 SIMD 연산으로 동시 처리할 수 있다. 다차원 질의가 단일 비트 연산으로 통합된다.

**우아한 열화.** 비트 계층 구조의 부산물로, 하위 비트 손실 시 시간이 왜곡 대신 추상화된다. 의도적 해상도 축소와 비의도적 데이터 손실이 동일한 수학적 구조를 갖는다.

DFC는 IP 서브넷 마스크가 주소 공간에 한 일을 시간 공간에 적용한 것이다.

---

*박준우 — GEUL 프로젝트*
