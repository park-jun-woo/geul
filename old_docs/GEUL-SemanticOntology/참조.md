# 참조 GEUL-SO (Reference GEUL-SO)

## 0. 정의 및 목적

### 정의
개체들 간의 관계, 속성, 연결을 표현하는 GEUL-SO. 서술 GEUL-O가 사실과 지식을 구조화할 때 사용하는 핵심 의미소.

### 목적
- 위키데이터 스타일의 Statement(주장-한정자-참조) 구조를 GEUL로 완벽 포팅
- 관계의 맥락(시간, 조건, 출처)을 명시적으로 표현
- 불확실한 지식과 다중 가설을 확률적으로 모델링
- GNN과 트랜스포머가 효율적으로 처리할 수 있는 구조 제공

## 1. 기본 구조

### 1.1 참조 포인터 패킷
```
[L][H: 0x10(Reference)][B: RelationObjectID]
```
- **헤더**: 참조를 나타내는 시스템 예약 의미소 ID (0x10)
- **바디**: 관계 객체 GEUL-O를 가리키는 고유 ID (8바이트)
- **역할**: 서술 GEUL-O가 상세한 관계 정보를 담은 독립 객체를 참조

### 1.2 관계 객체 구성 요소

#### a) 참조 타입 패킷 (Reference Type)
```
[L][H: 0x11(RefType)][B: PropertyID]
```
- **용도**: 관계의 종류를 정의 (예: '수도', '배우자', '직위')
- **바디**: 속성 개념을 나타내는 의미소 ID

#### b) 참조 대상 패킷 (Reference Target)
```
[L][H: 0x12(RefTarget)][B: TargetObjectID]
```
- **용도**: 관계의 대상이 되는 GEUL-O를 지정
- **바디**: 대상 GEUL-O의 고유 ID

#### c) 참조 한정자 패킷 (Reference Qualifier)
```
[L][H: 0x13(RefQualifier)][B: QualifierData]
```
- **구조**: [QualifierTypeID][QualifierValue]
- **용도**: 관계에 대한 부가 정보 (시작일, 종료일, 서수 등)

#### d) 참조 역방향 패킷 (Reference Inverse) - 선택적
```
[L][H: 0x14(RefInverse)][B: InversePropertyID]
```
- **용도**: 역관계 표현 (예: '수도' ↔ '속한 국가')

#### e) 신뢰도 패킷 (Confidence Score)
```
[L][H: 0x15(Confidence)][B: ConfidenceValue]
```
- **용도**: 이 관계의 확실성 (0.0 ~ 1.0)

## 2. 확률 중첩 참조 (Probabilistic Superposition Reference)

### 2.1 핵심 개념
단일 진실(Single Truth)이 아닌 **확률적 가능성의 중첩**을 표현. 불확실한 지식, 다중 가설, 미래 예측 등을 정확하게 모델링.

### 2.2 확률 중첩 참조 패킷
```
[L][H: 0x16(ProbabilisticRef)][B: SuperpositionObjectID]
```

### 2.3 중첩 객체 구조
```yaml
SuperpositionObject:
  ObjectID: Superposition_XXX
  Packets:
    # 메타 정보
    - [H: 0x17(SuperpositionType)][B: Type]     # 중첩 타입
    - [H: 0x18(TotalProbability)][B: 1.0]       # 정규화 확인
    - [H: 0x19(ConfidenceLevel)][B: Value]      # 전체 신뢰도
    
    # 가능성들
    - [H: 0x1A(Possibility)][B: PossibilityObject_001]
    - [H: 0x1A(Possibility)][B: PossibilityObject_002]
    - [H: 0x1A(Possibility)][B: PossibilityObject_003]
```

### 2.4 개별 가능성 객체
```yaml
PossibilityObject:
  Packets:
    - [H: 0x11(RefType)][B: PropertyID]         # 관계 타입
    - [H: 0x12(RefTarget)][B: TargetObjectID]   # 대상
    - [H: 0x1B(Probability)][B: 0.6]            # 확률
    - [H: 0x1C(Evidence)][B: EvidenceObjectID]  # 근거
    - [H: 0x1D(Uncertainty)][B: ±0.1]           # 불확실성 범위
```

### 2.5 중첩 타입 분류
- **exclusive**: 상호 배타적 (날씨 상태)
- **coexistent**: 동시 존재 가능 (복합 원인)
- **hierarchical**: 계층적 확률 분포
- **quantum**: 양자적 중첩 상태

## 3. 실제 구현 예시

### 3.1 확정적 관계: "대한민국의 수도는 서울"

#### 대한민국 GEUL-O
```yaml
ObjectID: Q884
Packets:
  - [H: 이름][B: "대한민국"]
  - [H: 0x10(Reference)][B: Relation_Capital_001]
```

#### 수도 관계 객체
```yaml
ObjectID: Relation_Capital_001
Packets:
  - [H: 0x11(RefType)][B: P36_ID]        # 속성: '수도'
  - [H: 0x12(RefTarget)][B: Q8684_ID]    # 대상: '서울'
  - [H: 0x13(RefQualifier)][B: [P580]["1948-08-15"]]  # 시작일
  - [H: 0x15(Confidence)][B: 1.0]        # 확실한 사실
```

### 3.2 확률적 관계: "공룡 멸종 원인"

#### 공룡 멸종 GEUL-O
```yaml
ObjectID: DinosaurExtinction
Packets:
  - [H: 이름][B: "K-Pg 대멸종"]
  - [H: 0x16(ProbabilisticRef)][B: Extinction_Causes_Super]
```

#### 멸종 원인 중첩 객체
```yaml
ObjectID: Extinction_Causes_Super
Packets:
  - [H: 0x17(SuperpositionType)][B: "coexistent"]
  - [H: 0x18(TotalProbability)][B: 1.0]
  - [H: 0x19(ConfidenceLevel)][B: 0.75]
  
  - [H: 0x1A(Possibility)][B: Asteroid_Hypothesis]
  - [H: 0x1A(Possibility)][B: Volcanic_Hypothesis]
  - [H: 0x1A(Possibility)][B: Combined_Hypothesis]
```

#### 운석 충돌 가설
```yaml
ObjectID: Asteroid_Hypothesis
Packets:
  - [H: 0x11(RefType)][B: "caused_by"]
  - [H: 0x12(RefTarget)][B: "칙술루브_충돌"]
  - [H: 0x1B(Probability)][B: 0.6]
  - [H: 0x1C(Evidence)][B: "이리듐층_증거"]
  - [H: 0x1D(Uncertainty)][B: ±0.15]
```

### 3.3 시간 의존적 확률: "내일 날씨"

#### 날씨 예보 GEUL-O
```yaml
ObjectID: Weather_2025_09_12
Packets:
  - [H: 장소][B: "서울"]
  - [H: 시간][B: "2025-09-12"]
  - [H: 0x16(ProbabilisticRef)][B: Weather_Super]
```

#### 날씨 상태 중첩
```yaml
ObjectID: Weather_Super
Packets:
  - [H: 0x17(SuperpositionType)][B: "exclusive"]
  - [H: 0x1A(Possibility)][B: Sunny_70]   # 맑음 70%
  - [H: 0x1A(Possibility)][B: Cloudy_10]  # 흐림 10%
  - [H: 0x1A(Possibility)][B: Rainy_20]   # 비 20%
```

## 4. 우아한 열화 (Graceful Degradation)

### 4.1 확정적 참조의 열화
```
고해상도: 대한민국 --[수도/1948년부터/헌법근거]--> 서울
중간해상도: 대한민국 --[수도]--> 서울  
저해상도: 대한민국 --[관계있음]--> 서울
```

### 4.2 확률적 참조의 열화
```
고해상도: 운석충돌 60%±15%, 화산활동 30%±10%, 복합 10%±5%
중간해상도: 운석충돌 가능성 높음, 화산활동 가능성 있음
저해상도: 여러 원인 가능
최저해상도: 원인 불확실
```

## 5. GNN/트랜스포머 처리

### 5.1 GNN의 관계 그래프 처리
```python
def process_reference_graph(entity_obj, relation_objs):
    # 확정적 관계 처리
    for rel in deterministic_relations:
        edge_vector = encode_relation(rel.type, rel.target)
        entity_vector += message_passing(edge_vector)
    
    # 확률적 관계 처리
    for superposition in probabilistic_relations:
        weighted_vectors = []
        for possibility in superposition.possibilities:
            vec = encode_possibility(possibility)
            weighted_vectors.append(vec * possibility.probability)
        
        entity_vector += weighted_sum(weighted_vectors)
    
    return entity_vector
```

### 5.2 트랜스포머의 추론 처리
```python
def transformer_reasoning(query, reference_vectors):
    if requires_certainty(query):
        # 확정적 답변 필요 시
        return process_deterministic_refs(reference_vectors)
    else:
        # 확률적 추론
        return probabilistic_reasoning(reference_vectors)
```

## 6. INT8 스트림 예시

### 도널드 트럼프의 45대 대통령직 (확정적)
```
# 관계 객체
FE 01010101010101F1 04000000
  FC 00000000 0200 1100 0200 2700 FB  # 타입: 직위
  FC 01000000 0200 1200 0800 A02D000000000000 FB  # 대상: 대통령
  FC 02000000 0200 4402 0A00 323031372D30312D3230 FB  # 시작일
  FC 03000000 0200 0906 0200 3435 FB  # 서수: 45
FD
```

### 공룡 멸종 원인 (확률적)
```
# 중첩 객체
FE 02020202020202F2 05000000
  FC 00000000 0200 1700 0200 0002 FB  # 타입: coexistent
  FC 01000000 0200 1800 0200 FF00 FB  # 총확률: 1.0
  FC 02000000 0200 1900 0200 C000 FB  # 신뢰도: 0.75
  FC 03000000 0200 1A00 0800 [Asteroid_ID] FB  # 가능성1
  FC 04000000 0200 1A00 0800 [Volcanic_ID] FB  # 가능성2
FD
```

## 7. 설계의 장점

- **모듈성**: 각 관계가 독립 객체로 재사용 가능
- **확장성**: 새로운 한정자는 패킷 추가로 간단히 확장
- **명확성**: 모든 부사 정보가 어떤 관계에 속하는지 명확
- **불확실성 표현**: 확률적 지식을 정직하게 모델링
- **GNN 친화성**: 그래프 구조를 자연스럽게 표현
- **트랜스포머 호환성**: 압축된 벡터로 효율적 추론

## 8. 메타데이터

- **CreatedBy**: 관계 생성 주체
- **LastModified**: 마지막 수정 시각
- **Source**: 출처 정보
- **ValidationStatus**: 검증 상태

## 9. 요약

참조 GEUL-SO는 확정적 사실부터 불확실한 가설까지, 단순 속성부터 복잡한 관계까지 모든 형태의 지식 연결을 표현할 수 있는 **범용 관계 표현 체계**입니다. 특히 확률 중첩 참조를 통해 인간의 불완전한 지식 상태까지도 정확하게 모델링하여, GEUL이 진정한 지식 표현 언어로 기능하게 합니다.